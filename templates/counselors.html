<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Counselors - Student Support Center</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="page">
    <header class="top-bar">
      <div class="logo-circle">SSC</div>
      <h1>Counselors</h1>
    </header>

    <main class="content">
      <div class="card hero">
        <h2>Counselors</h2>
        <p>View counselor information from the database.</p>
        <p style="margin-top: 0.5rem;">
          <a href="{{ url_for('add_counselor') }}" class="button-link">+ Add Counselor</a>
          <a href="{{ url_for('home') }}" class="button-link secondary">← Back to Dashboard</a>
        </p>

        <form method="get">
          <label>Type:
            <select name="type">
              <option value="">Any</option>
              <option value="paid" {% if type_filter == 'paid' %}selected{% endif %}>Paid</option>
              <option value="volunteer" {% if type_filter == 'volunteer' %}selected{% endif %}>Volunteer</option>
            </select>
          </label>

          <label>Education:
            <select name="education">
              <option value="">Any</option>
              {% for edu in educations %}
                <option value="{{ edu }}" {% if education_filter == edu %}selected{% endif %}>{{ edu }}</option>
              {% endfor %}
            </select>
          </label>

          <label>Experience:
            <select name="exp_operator">
              <option value=">=" {% if exp_operator == ">=" %}selected{% endif %}>>=</option>
              <option value="<=" {% if exp_operator == "<=" %}selected{% endif %}><=</option>
              <option value="=" {% if exp_operator == "=" %}selected{% endif %}>=</option>
            </select>
            <input type="number" name="exp_value" value="{{ exp_value }}">
          </label>

          <label>Salary:
            <select name="salary_operator">
              <option value=">=" {% if salary_operator == ">=" %}selected{% endif %}>>=</option>
              <option value="<=" {% if salary_operator == "<=" %}selected{% endif %}><=</option>
              <option value="=" {% if salary_operator == "=" %}selected{% endif %}>=</option>
            </select>
            <input type="number" name="salary_value" value="{{ salary_value }}">
          </label>

          <button type="submit">Filter</button>
        </form>
      </div>

      <div class="card">
        <table class="table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Type</th>
              <th>Education</th>
              <th>Experience (years)</th>
              <th>
                <a href="{{ url_for('list_counselors',
                                     type=type_filter,
                                     education=education_filter,
                                     exp_operator=exp_operator,
                                     exp_value=exp_value,
                                     salary_operator=salary_operator,
                                     salary_value=salary_value,
                                     sort='salary',
                                     order='asc' if order != 'asc' else 'desc') }}">
                  Salary
                  {% if sort == 'salary' %}
                    {% if order == 'asc' %} ▲ {% else %} ▼ {% endif %}
                  {% endif %}
                </a>
              </th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody>
            {% for c in counselors %}
              <tr>
                <td><a href="{{ url_for('counselor_view', counselor_id=c.counselor_id) }}">{{ c.counselor_id }}</a></td>
                <td>{{ c.name }}</td>
                <td>{{ c.paid_volunteer }}</td>
                <td>{{ c.education }}</td>
                <td>{{ c.experience }}</td>
                <td>{% if c.salary %}${{ c.salary }}{% else %}—{% endif %}</td>
                <td>
                  <form method="POST" action="{{ url_for('delete_counselor', counselor_id=c.counselor_id) }}" style="display:inline;">
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this counselor?');" class="button-link danger">Delete</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="card" style="margin-top:1rem; padding:1rem;">
        <h3>Average Salary</h3>
        <p style="font-size:1.2rem;">
          {% if avg_salary %}
            ${{ "%.2f" | format(avg_salary) }}
          {% else %}
            N/A
          {% endif %}
        </p>
      </div>

    </main>
  </div>
</body>
</html>
